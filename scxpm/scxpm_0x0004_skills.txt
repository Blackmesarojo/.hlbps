#if defined _scxpm_skills_included
    #endinput
#endif
#define _scxpm_skills_included

// Definiciones de habilidades
#define SKILL_HEALTH 1
#define SKILL_ARMOR 2
#define SKILL_REGEN_HP 3
#define SKILL_REGEN_AP 4
#define SKILL_DISTANCE 5
#define MAX_SKILLS 5

// Variables locales del módulo
new g_iPlayerSkills[33][MAX_SKILLS + 1];

public SCXPM_Skills_Init()
{
    register_cvar("scxpm_skill_maxlevel", "50");
    return PLUGIN_CONTINUE;
}

public SCXPM_GiveSkill(id, skill)
{
    if(!is_user_connected(id) || !g_bLoaded[id])
        return PLUGIN_HANDLED;
        
    if(skill < 1 || skill > MAX_SKILLS)
        return PLUGIN_HANDLED;
        
    if(g_iSkillPoints[id] < 1)
        return PLUGIN_HANDLED;
        
    new max_level = get_cvar_num("scxpm_skill_maxlevel");
    if(g_iPlayerSkills[id][skill] >= max_level)
        return PLUGIN_HANDLED;
        
    g_iPlayerSkills[id][skill]++;
    g_iSkillPoints[id]--;
    
    SCXPM_ApplySkills(id);
    
    return PLUGIN_CONTINUE;
}

public SCXPM_ApplySkills(id)
{
    if(!is_user_connected(id) || !g_bLoaded[id])
        return PLUGIN_HANDLED;
        
    // Aplicar salud extra
    new health_bonus = g_iPlayerSkills[id][SKILL_HEALTH] * 2;
    set_user_health(id, get_user_health(id) + health_bonus);
    
    // Aplicar armadura extra
    new armor_bonus = g_iPlayerSkills[id][SKILL_ARMOR] * 2;
    set_user_armor(id, get_user_armor(id) + armor_bonus);
    
    // Aplicar regeneración
    g_iRegenHealth[id] = g_iPlayerSkills[id][SKILL_REGEN_HP];
    g_iRegenArmor[id] = g_iPlayerSkills[id][SKILL_REGEN_AP];
    
    // Aplicar distancia
    g_iDistance[id] = g_iPlayerSkills[id][SKILL_DISTANCE];
    
    return PLUGIN_CONTINUE;
}